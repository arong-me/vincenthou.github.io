好久没有梳理知识了，最近在做一些前端性能优化的尝试，一些心得和知识记录下来。
网站性能优化从来都不是一个孤立的点，完善的优化一定是要前后端协同配合
# 经典Web优化14条准则：

1.减少HTTP请求数：合并文件，CSS Sprite(工具网站)
2. 使用CDN：DNS负载均衡将请求分发到近用户的cache服务器
3. 添加Expire/Cache-Control头（甚用）
4. 启用Gzip压缩：压缩85%
5. CSS放在页面上端：浏览器只会在CSS全部加载完成后渲染
6. Script放在页面最下面：减少可视内容加载时间，阻塞并行下载
7. 避免CSS表达式
8. 外部化CSS和JS文件
9. 减少DNS查询：一个页面包含域名数2-4个
10. 压缩JS和CSS文件
11. 减少重定向
12. 移除重复脚本，提高重用性
13. 配置实体标签ETags：标识资源有效性的标签，Spring Hibernate
14. 缓存AJAX请求：参考3，使用时间戳
# 16ms优化
- You can't optimize what you can not measure
- 优化目标：脚本时间+渲染时间+绘制时间<16ms（每帧）
- 工具：Timeline, Profiles, UI Responsiveness, Profile, Traker(Dron blog)
- 每帧最多发生两次DOM更新
# Google 1s完成终端首屏渲染：
1. 服务器响应小于200ms
2. 尽量少的重定向
3. 尽量少的第一次请求数
4. 避免过多堵塞JS和CSS
5. 给浏览器留200ms渲染时间
6. 优化JS执行和渲染时间
7. 减少DNS Lookup
8. 并行请求
9. 压缩
10. 缓存
11. 按需加载
12. 模块化
# JS性能优化最佳实践
1. 使用DocumentFragment或者innerHTML进行大块元素注入
2. 高频执行事件的消抖：参考underscore的debounce
3. 使用Session Storage存静态内容或片段
4. 使用异步加载或者延迟加载依赖文件：RequireJS, curl
5. 使用array的join方法连接字符串：先将字符片段push到数组中，再join
6. 使用CSS3动画：transform: transform3d(0,0,0)强制硬件加速
7. 对于频繁更改或者大量的元素父元素添加事件代理
8. 使用Data URI代替图片src
9. 使用媒体查询加载指定大小的图片
10. 对于频繁查询的列表根据key值建立索引表，减少遍历
11. 控制DOM元素数量：使用before after伪元素，延迟加载和呈现内容，使用事件委托12. 将节点转化为字符串存储
12. 使用Web workers处理负责计算，保证UI渲染流畅性
13. 避免使用@import, 使用SASS将文件合并
14. 将多份媒体查询代码合并
# 移动端良好体验的标准
- 流畅：动画和滑动
- 稳定：很少crash
- 节能：省电

渲染过程
![image](https://app.yinxiang.com/shard/s15/res/983b5eff-a042-4127-af1e-20823e9e6d56/IMG_20131118_102334.249.jpg?resizeSmall&width=700)
# 工具
- [Webpagetest](http://www.webpagetest.org/)
# 参考资料：
- [stevesouders](http://stevesouders.com/)
- [bookofspeed](http://www.bookofspeed.com/)
