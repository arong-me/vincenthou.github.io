<!DOCTYPE html>


  <html class="light page-post">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <link rel="dns-prefetch" href="//vdemo.qiniudn.com">
  <link rel="dns-prefetch" href="//user-images.githubusercontent.com">
  
  <title>php 编码规范 | VincentHou</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="blog,php,">
  

  <meta name="description" content="PHP编码规范基本原则 简洁，清晰，一致[[BR]] 健壮[[BR]] 注意细节[[BR]] 第一次将事情做好[[BR]]格式化 使用UTF-8作为文件编码格式 使用空格代替Tab 运算符两端分别留一个空格  12345//wrong$foo=$bar;//right$foo = $bar;  使用空行分隔逻辑代码块  123456789//get request parameters$keywo">
<meta name="keywords" content="blog,php">
<meta property="og:type" content="article">
<meta property="og:title" content="php 编码规范">
<meta property="og:url" content="https://vincenthou.github.io/2013/12/16/php-编码规范/index.html">
<meta property="og:site_name" content="VincentHou">
<meta property="og:description" content="PHP编码规范基本原则 简洁，清晰，一致[[BR]] 健壮[[BR]] 注意细节[[BR]] 第一次将事情做好[[BR]]格式化 使用UTF-8作为文件编码格式 使用空格代替Tab 运算符两端分别留一个空格  12345//wrong$foo=$bar;//right$foo = $bar;  使用空行分隔逻辑代码块  123456789//get request parameters$keywo">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-04-18T12:59:06.515Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="php 编码规范">
<meta name="twitter:description" content="PHP编码规范基本原则 简洁，清晰，一致[[BR]] 健壮[[BR]] 注意细节[[BR]] 第一次将事情做好[[BR]]格式化 使用UTF-8作为文件编码格式 使用空格代替Tab 运算符两端分别留一个空格  12345//wrong$foo=$bar;//right$foo = $bar;  使用空行分隔逻辑代码块  123456789//get request parameters$keywo">

  

  
    <link rel="icon" href="//assets-cdn.github.com/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/style.css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-39656503-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?1e5d8068abdfb22e27ebe052a4feae14";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>
</html>
<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">更多</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">更多</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP编码规范"><span class="toc-text">PHP编码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#基本原则"><span class="toc-text">基本原则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#格式化"><span class="toc-text">格式化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#命名"><span class="toc-text">命名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注释"><span class="toc-text">注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最佳实践"><span class="toc-text">最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-text">参考</span></a></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-php-编码规范" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">php 编码规范</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2013.12.16</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Vincent Hou</span>
        </span>
      

      


      
        <span>
          <i class="icon-comment"></i>
          <a href="http://vincenthou.github.io/2013/12/16/php-编码规范/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      

      
      
    </div>
  </header>

  <div class="article-content">
    
      <h1 id="PHP编码规范"><a href="#PHP编码规范" class="headerlink" title="PHP编码规范"></a>PHP编码规范</h1><h2 id="基本原则"><a href="#基本原则" class="headerlink" title="基本原则"></a>基本原则</h2><ul>
<li>简洁，清晰，一致[[BR]]</li>
<li>健壮[[BR]]</li>
<li>注意细节[[BR]]</li>
<li>第一次将事情做好[[BR]]<h2 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h2></li>
<li>使用UTF-8作为文件编码格式</li>
<li>使用空格代替Tab</li>
<li>运算符两端分别留一个空格</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//wrong</span></span><br><span class="line">$foo=$bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line">$foo = $bar;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用空行分隔逻辑代码块</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get request parameters</span></span><br><span class="line">$keyword =  Yii::app()-&gt;request-&gt;getQuery(<span class="string">'keyword'</span>);</span><br><span class="line">$pageSize =  Yii::app()-&gt;request-&gt;getQuery(<span class="string">'pageSize'</span>);</span><br><span class="line">Yii::log(<span class="string">'request: keyword-&gt;'</span> . $keyword . <span class="string">' pageSize-&gt;'</span> . $pageSize, <span class="string">'debug'</span>, <span class="string">'system.trip.getSystemTags'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//get data from backend</span></span><br><span class="line">$curl = <span class="keyword">new</span> Curl();</span><br><span class="line">$result = $curl-&gt;get(<span class="string">'/tag/list'</span>, <span class="keyword">array</span>(<span class="string">'keyword'</span>=&gt;urlencode($keyword), <span class="string">'pageSize'</span>=&gt;$pageSize));</span><br><span class="line"><span class="keyword">echo</span> $result;</span><br></pre></td></tr></table></figure>
<ul>
<li>逻辑代码块哪怕只有一行也要用{}包裹起来，关键字与条件的左括号之间要空一格</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (...)</span><br><span class="line">&#123;</span><br><span class="line">    bar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>switch语句的每一个case都要以break结束，并且有一个default的声明（同样以break结束）</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (condition)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        action1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        action A...;</span><br><span class="line">        action B...;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">default</span> action;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>流程控制的不同部分，新行要以关键字开始而不是“{”</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//wrong</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>函数名与参数列表之间不留空格，不同的参数在“,”之后留一个空格（同样适用于数组）</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//wrong</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_records</span> <span class="params">($table,$parameters,$conditions)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_records</span><span class="params">($table, $parameters, $conditions)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//wrong</span></span><br><span class="line">$some_array = <span class="keyword">array</span> (<span class="string">'hello'</span>,<span class="string">'world'</span>,<span class="string">'foo'</span>=&gt;<span class="string">'bar'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line">$some_array = <span class="keyword">array</span>(<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'foo'</span> =&gt; <span class="string">'bar'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>不依赖默认的操作符优先级，使用()明确表示出运算的优先级</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//wrong</span></span><br><span class="line"><span class="keyword">if</span>($row[<span class="string">"col_a"</span>] == <span class="number">3</span> &amp;&amp; $row[<span class="string">"col_b"</span>] == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line"><span class="keyword">if</span>((<span class="number">3</span> == $row[<span class="string">'col_a'</span>]) &amp;&amp; (<span class="number">1</span> == $row[<span class="string">'col_b'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>普通字符串使用单引号包裹，避免使用双引号</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//wrong</span></span><br><span class="line">$str = <span class="string">"Hello world"</span>;</span><br><span class="line">$jointStr = <span class="string">"Hello world $str"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line">$str = <span class="string">'Hello world'</span>;</span><br><span class="line">$jointStr = <span class="string">'Hello world'</span> . $str;</span><br></pre></td></tr></table></figure>
<ul>
<li>类中的方法和变量的访问权限使用public、protected、private关键字显示标识</li>
<li>进行类型转换时，使用括号将目标类型包裹起来，并与变量之间留一个空格</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(int) $mynumber</span><br></pre></td></tr></table></figure>
<ul>
<li>过长的控制条件，差分成若干变量，计算出变量结果后再进行逻辑组合判断</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Key is only valid if it matches the current user's ID, as otherwise other</span></span><br><span class="line"><span class="comment">// users could access any user's things.</span></span><br><span class="line">$is_valid_user = (<span class="keyword">isset</span>($key) &amp;&amp; !<span class="keyword">empty</span>($user-&gt;uid) &amp;&amp; $key == $user-&gt;uid);</span><br><span class="line"></span><br><span class="line"><span class="comment">// IP must match the cache to prevent session spoofing.</span></span><br><span class="line">$is_valid_cache = (<span class="keyword">isset</span>($user-&gt;cache) ? $user-&gt;cache == ip_address() : <span class="keyword">FALSE</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Alternatively, if the request query parameter is in the future, then it</span></span><br><span class="line"><span class="comment">// is always valid, because the galaxy will implode and collapse anyway.</span></span><br><span class="line">$is_valid_query = $is_valid_cache || (<span class="keyword">isset</span>($value) &amp;&amp; $value &gt;= time());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($is_valid_user || $is_valid_query)</span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h2><ul>
<li>使用NULL初始化空字符串</li>
<li><p>文件名和类名首字母大写，使用驼峰命名法 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Example:** Circle, FilledCircled, ShadedFilledCircle</span><br></pre></td></tr></table></figure>
</li>
<li><p>全局方法使用小写字母命名使用“_”分隔 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Example:** is_valid(), get_script_name()</span><br></pre></td></tr></table></figure>
</li>
<li><p>类方法使用驼峰命名法，动宾结构，首字母小写 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Example:** draw(), drawLine(), getName()</span><br></pre></td></tr></table></figure>
</li>
<li><p>普通变量和类成员变量使用驼峰命名法，首字母小写，私有成员以_开头 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Example:** $currentTime，$_privateVal</span><br></pre></td></tr></table></figure>
</li>
<li><p>常量全部使用大写字母命名，以“_”分隔 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Example:** PI, MAX_BUFFER_SIZE</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><ul>
<li>使用empty标识空执行</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (condition)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//empty!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>文件开头书写注释标识作者、网站主页、版权信息</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * CBooleanValidator class file.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Qiang Xue &lt;qiang.xue<span class="doctag">@gmail</span>.com&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@link</span> http://www.yiiframework.com/</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@copyright</span> Copyright &amp;copy; 2008-2011 Yii Software LLC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@license</span> http://www.yiiframework.com/license/</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>类定义上方书写注释阐述类的应用场景、作者、版本号、所属的包名称</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * CDefaultValueValidator sets the attributes with the specified value.</span></span><br><span class="line"><span class="comment"> * It does not do validation. Its existence is mainly to allow</span></span><br><span class="line"><span class="comment"> * specifying attribute default values in a dynamic way.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Qiang Xue &lt;qiang.xue<span class="doctag">@gmail</span>.com&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 0.1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> system.validators</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>类成员变量上方书写注释阐述变量的类型、意义、默认值等信息</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@var</span> boolean whether to set the default value only when the attribute value is null or empty string.</span></span><br><span class="line"><span class="comment"> * Defaults to true. If false, the attribute will always be assigned with the default value,</span></span><br><span class="line"><span class="comment"> * even if it is already explicitly assigned a value.</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>定义方法上方书写注释阐述方法的用途，使用@param详述参数的信息（包括参数类型以及意义），使用@return详述返回值的信息，如果有异常抛出使用@throws注解</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the JavaScript needed for performing client-side validation.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> CModel $object the data object being validated</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $attribute the name of the attribute to be validated.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> string the client-side validation script.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> CActiveForm::enableClientValidation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.1.7</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>对于实现较为复杂的代码，以空行分隔逻辑块的同时，使用单行注释解释逻辑块的作用</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Put table and key name in variables for easier reading</span></span><br><span class="line">$refTable=$fkEntry[<span class="number">0</span>]; <span class="comment">// Table name that current fk references to</span></span><br><span class="line">$refKey=$fkEntry[<span class="number">1</span>];   <span class="comment">// Key in that table being referenced</span></span><br><span class="line">$refClassName=<span class="keyword">$this</span>-&gt;generateClassName($refTable);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add relation for this table</span></span><br><span class="line">$relationName=<span class="keyword">$this</span>-&gt;generateRelationName($tableName, $fkName, <span class="keyword">false</span>);</span><br><span class="line">$relations[$className][$relationName]=<span class="string">"array(self::BELONGS_TO, '$refClassName', '$fkName')"</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>对于尚未完成的工作使用单行注释 TODO 标注 <h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2></li>
<li>谨慎使用’echo’, ‘print’, ‘prin_r’和’die’,确保你真的需要它们</li>
<li>避免使用魔法数，所用的常量使用const定义，所有字母大写以“_”分隔</li>
<li>Controller中主要完成获取用户输入，从model层获取数据，选择页面渲染的工作<ul>
<li>HTML和数据字段名不能写在其中，而应该写在view中</li>
<li>SQL不能写在其中，而应该写在model中，提供方法给controller调用 </li>
</ul>
</li>
<li>所有的controller不能直接继承CController，而是需要自定义一个controller来继承CController，所有其他添加的controller均继承该controller</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Controller is the customized base controller class.</span></span><br><span class="line"><span class="comment"> * All controller classes for this application should extend from this base class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Controller</span> <span class="keyword">extends</span> <span class="title">CController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string the default layout for the controller view. Defaults to '//layouts/column1',</span></span><br><span class="line"><span class="comment">     * meaning using a single column layout. See 'protected/views/layouts/column1.php'.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> $layout=<span class="string">'//layouts/main'</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array context menu items. This property will be assigned to &#123;<span class="doctag">@link</span> CMenu::items&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> $menu=<span class="keyword">array</span>();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array the breadcrumbs of the current page. The value of this property will</span></span><br><span class="line"><span class="comment">     * be assigned to &#123;<span class="doctag">@link</span> CBreadcrumbs::links&#125;. Please refer to &#123;<span class="doctag">@link</span> CBreadcrumbs::links&#125;</span></span><br><span class="line"><span class="comment">     * for more details on how to specify this property.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> $breadcrumbs=<span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">beforeAction</span><span class="params">($action)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>View中主要存放HTML代码，从controller获取数据进行渲染，包含尽量少的逻辑代码<ul>
<li>收集用户输入（例如 $_GET 和 $_POST）不能写在其中，而应该写在controller中</li>
<li>SQL不能写在其中，而应该写在model中，提供方法给controller调用<br>模板中的控制语句使用标识性语句而非括号</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//wrong</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($item)) &#123; <span class="meta">?&gt;</span></span><br><span class="line">  &lt;p&gt;<span class="meta">&lt;?php</span> <span class="keyword">print</span> $item; <span class="meta">?&gt;</span>&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span> ($items <span class="keyword">as</span> $item) &#123; <span class="meta">?&gt;</span></span><br><span class="line">  &lt;p&gt;<span class="meta">&lt;?php</span> <span class="keyword">print</span> $item; <span class="meta">?&gt;</span>&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($item)): <span class="meta">?&gt;</span></span><br><span class="line">  &lt;p&gt;<span class="meta">&lt;?php</span> <span class="keyword">print</span> $item; <span class="meta">?&gt;</span>&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span> ($items <span class="keyword">as</span> $item): <span class="meta">?&gt;</span></span><br><span class="line">  &lt;p&gt;<span class="meta">&lt;?php</span> <span class="keyword">print</span> $item; <span class="meta">?&gt;</span>&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>数据库表名和字段名使用小写字母，以_分隔多个单词，使用前缀名区分一个数据库下相同表名 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Example:** product_order</span><br></pre></td></tr></table></figure>
</li>
<li><p>Model中主要负责对于数据库的访问，为controller提供数据接口</p>
<ul>
<li>HTML不应该写在其中，而应该写在view中 </li>
</ul>
</li>
<li>对于简单重复数据库操作；使用AR进行查询，当涉及到多表关联，复杂操作或者性能敏感时使用SQL查询；如果只是进行查询操作，并且兼顾易用性和性能可以使用Query Builder</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//AR save</span></span><br><span class="line">$post=<span class="keyword">new</span> Post;</span><br><span class="line">$post-&gt;title=<span class="string">'sample post'</span>;</span><br><span class="line">$post-&gt;content=<span class="string">'post body content'</span>;</span><br><span class="line">$post-&gt;save();</span><br><span class="line"></span><br><span class="line"><span class="comment">//SQL query</span></span><br><span class="line">$sql=<span class="string">"SELECT username, email FROM tbl_user"</span>;</span><br><span class="line">$connection = Yii::app()-&gt;db;   <span class="comment">// 假设你已经建立了一个 "db" 连接</span></span><br><span class="line"><span class="comment">// 如果没有，你可能需要显式建立一个连接：</span></span><br><span class="line"><span class="comment">// $connection =n ew CDbConnection($dsn,$username,$password);</span></span><br><span class="line">$command = $connection-&gt;createCommand($sql);</span><br><span class="line"><span class="comment">// 如果需要，此 SQL 语句可通过如下方式修改：</span></span><br><span class="line"><span class="comment">// $command-&gt;text=$newSQL;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Query Builder</span></span><br><span class="line">$user = Yii::app()-&gt;db-&gt;createCommand()</span><br><span class="line">    -&gt;select(<span class="string">'id, username, profile'</span>)</span><br><span class="line">    -&gt;from(<span class="string">'tbl_user u'</span>)</span><br><span class="line">    -&gt;join(<span class="string">'tbl_profile p'</span>, <span class="string">'u.id=p.user_id'</span>)</span><br><span class="line">    -&gt;where(<span class="string">'id=:id'</span>, <span class="keyword">array</span>(<span class="string">':id'</span>=&gt;$id))</span><br><span class="line">    -&gt;queryRow();</span><br></pre></td></tr></table></figure>
<ul>
<li>对于log信息分级，并且明确指定所属的分类名称。调试信息使用trace，产品级信息根据价值程度选择特定的级别，具体可参考[<a href="http://www.yiiframework.com/doc/guide/1.1/en/topics.logging" target="_blank" rel="noopener">http://www.yiiframework.com/doc/guide/1.1/en/topics.logging</a> Logging Topic]</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yii::log(<span class="string">'request group list: '</span> .$groupList , <span class="string">'trace'</span>, <span class="string">'system.group.search'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>对于可复用的页面组件或者较为复杂的页面成分，应该抽离出widget，拥有自己独立的view，具体可参考<ul>
<li>[<a href="http://www.yiiframework.com/wiki/23/how-to-create-a-breadcrumb-widget" target="_blank" rel="noopener">http://www.yiiframework.com/wiki/23/how-to-create-a-breadcrumb-widget</a> Simple Example]</li>
<li>[<a href="http://www.yiiframework.com/doc/guide/1.1/en/basics.view#widget" target="_blank" rel="noopener">http://www.yiiframework.com/doc/guide/1.1/en/basics.view#widget</a> Widget View]</li>
</ul>
</li>
<li>抛出的异常要明确到某个特定的类型，所有抛出异常的部分使用catch分类捕获，根据具体情况能够处理的直接处理，不能处理的继续抛出</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(AppException $e)</span><br><span class="line">&#123;</span><br><span class="line">    ErrorHandler::handleDefaultError($e);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;render(<span class="string">'search'</span>, <span class="keyword">array</span>(<span class="string">'filterParams'</span>=&gt;$filterParams));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(SystemException $e)</span><br><span class="line">&#123;</span><br><span class="line">    ErrorHandler::handleDefaultError($e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>由于PHP暂时不支持finally，在异常被捕获之后，或者异常处理结束之后的控制流程中清理资源（例如数据库连接等）</li>
<li>异常捕获后不能阻塞程序的正常执行，或者容错处理，或者跳转到错误页面</li>
<li>对异常进行合理的分层，例如不要将SQLException放置到非数据处理层，而出现在业务逻辑层 <h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2></li>
</ul>
<p><a href="https://drupal.org/coding-standards#helpermod" target="_blank" rel="noopener">Drupal Coding Standards</a><br><a href="http://www.yiiframework.com/wiki/102/code-style/" target="_blank" rel="noopener">Yii Code Style</a><br><a href="http://vadimg.com/2009/07/yii-php-coding-standards-draft/" target="_blank" rel="noopener">Yii Code Standard</a><br><a href="http://www.yiiframework.com/doc/guide/1.1/en/basics.convention" target="_blank" rel="noopener">Yii Conventions</a><br><a href="http://framework.zend.com/manual/1.12/en/coding-standard.html" target="_blank" rel="noopener">Zend Framework Coding Standards</a><br><a href="http://pear.php.net/manual/en/standards.php" target="_blank" rel="noopener">PHP Coding Standards</a></p>

    
  </div>
</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持vincenthou</div>
        <ul class="theme.donation.items.length">
        
          <li class="item">
            <img src="//vdemo.qiniudn.com/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            <img src="//vdemo.qiniudn.com/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2013/12/16/Css-Html-编码规范/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2013/12/16/javascript-编码规范/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'vincenthou';
    
    var disqus_url = 'https://vincenthou.github.io/2013/12/16/php-编码规范/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//vincenthou.disqus.com/count.js" async></script>



    




    

    
	
  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
